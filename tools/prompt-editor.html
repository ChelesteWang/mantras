<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mantras æç¤ºç¼–è¾‘å™¨</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: #f5f7fa; 
            color: #333;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .editor { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .panel { 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .form-group { margin-bottom: 15px; }
        label { 
            display: block; 
            margin-bottom: 5px; 
            font-weight: 500; 
            color: #374151;
        }
        input, textarea, select { 
            width: 100%; 
            padding: 8px 12px; 
            border: 1px solid #d1d5db; 
            border-radius: 6px; 
            font-size: 14px;
            transition: border-color 0.2s;
        }
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        textarea { 
            min-height: 120px; 
            font-family: 'Monaco', 'Menlo', monospace; 
            resize: vertical;
        }
        .template-area { min-height: 200px; }
        .preview { 
            background: #f8fafc; 
            padding: 15px; 
            border-radius: 6px; 
            border: 1px solid #e5e7eb;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .btn { 
            background: #3b82f6; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            margin-right: 10px;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        .btn:hover { background: #2563eb; }
        .btn-secondary { 
            background: #6b7280; 
        }
        .btn-secondary:hover { background: #4b5563; }
        .parameters { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 8px; 
            margin-top: 10px; 
        }
        .parameter-tag { 
            background: #dbeafe; 
            color: #1e40af;
            padding: 4px 8px; 
            border-radius: 4px; 
            font-size: 12px;
            font-family: 'Monaco', 'Menlo', monospace;
        }
        .tabs { 
            display: flex; 
            margin-bottom: 20px; 
            border-bottom: 1px solid #e5e7eb;
        }
        .tab { 
            padding: 12px 24px; 
            background: none;
            border: none; 
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        .tab.active { 
            color: #3b82f6;
            border-bottom-color: #3b82f6;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .success { color: #059669; }
        .error { color: #dc2626; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ Mantras æç¤ºç¼–è¾‘å™¨</h1>
            <p>å¿«é€Ÿåˆ›å»ºå’Œç¼–è¾‘æç¤ºå·¥ç¨‹æ¨¡æ¿</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('basic')">åŸºç¡€ä¿¡æ¯</button>
            <button class="tab" onclick="switchTab('template')">æ¨¡æ¿å†…å®¹</button>
            <button class="tab" onclick="switchTab('preview')">é¢„è§ˆå¯¼å‡º</button>
        </div>

        <div id="basic" class="tab-content active">
            <div class="editor">
                <div class="panel">
                    <h3>ğŸ“ åŸºç¡€ä¿¡æ¯</h3>
                    <div class="form-group">
                        <label>æ¨¡æ¿ID *</label>
                        <input type="text" id="templateId" placeholder="kebab-caseæ ¼å¼ï¼Œå¦‚ï¼šmy-template">
                    </div>
                    <div class="form-group">
                        <label>æ¨¡æ¿åç§° *</label>
                        <input type="text" id="templateName" placeholder="å¦‚ï¼šæˆ‘çš„æ¨¡æ¿">
                    </div>
                    <div class="form-group">
                        <label>æè¿°</label>
                        <textarea id="templateDesc" placeholder="ç®€çŸ­æè¿°æ¨¡æ¿çš„ç”¨é€”å’Œæ•ˆæœ"></textarea>
                    </div>
                    <div class="form-group">
                        <label>åˆ†ç±»</label>
                        <select id="templateCategory">
                            <option value="debugging">è°ƒè¯•</option>
                            <option value="refactoring">é‡æ„</option>
                            <option value="architecture">æ¶æ„</option>
                            <option value="optimization">ä¼˜åŒ–</option>
                            <option value="code-review">ä»£ç å®¡æŸ¥</option>
                            <option value="planning">è§„åˆ’</option>
                        </select>
                    </div>
                </div>
                <div class="panel">
                    <h3>ğŸ·ï¸ å…ƒæ•°æ®</h3>
                    <div class="form-group">
                        <label>æŠ€æœ¯åç§°</label>
                        <input type="text" id="templateTechnique" placeholder="snake_caseæ ¼å¼">
                    </div>
                    <div class="form-group">
                        <label>æ ‡ç­¾</label>
                        <input type="text" id="templateTags" placeholder="ç”¨é€—å·åˆ†éš”ï¼Œå¦‚ï¼šdebugging,analysis">
                    </div>
                    <div class="form-group">
                        <label>éš¾åº¦</label>
                        <select id="templateDifficulty">
                            <option value="beginner">åˆçº§</option>
                            <option value="intermediate">ä¸­çº§</option>
                            <option value="advanced">é«˜çº§</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <div id="template" class="tab-content">
            <div class="editor">
                <div class="panel">
                    <h3>ğŸ“‹ æ¨¡æ¿å†…å®¹</h3>
                    <div class="form-group">
                        <label>æ¨¡æ¿æ–‡æœ¬ (ä½¿ç”¨ {å‚æ•°å} è¡¨ç¤ºå‚æ•°) *</label>
                        <textarea id="templateContent" class="template-area" 
                                placeholder="è¾“å…¥æ¨¡æ¿å†…å®¹ï¼Œä½¿ç”¨ {å‚æ•°å} è¡¨ç¤ºå¯æ›¿æ¢çš„å‚æ•°&#10;&#10;ç¤ºä¾‹ï¼š&#10;ä½ æ˜¯ä¸€ä½èµ„æ·±çš„ {role} ä¸“å®¶ã€‚&#10;è¯·å¸®æˆ‘ {action} è¿™æ®µä»£ç ï¼š&#10;&#10;{code}"></textarea>
                    </div>
                    <div class="form-group">
                        <label>æ£€æµ‹åˆ°çš„å‚æ•°</label>
                        <div id="detectedParams" class="parameters"></div>
                    </div>
                </div>
                <div class="panel">
                    <h3>ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹</h3>
                    <div class="form-group">
                        <label>ç¤ºä¾‹åç§°</label>
                        <input type="text" id="exampleName" placeholder="å¦‚ï¼šJavaScriptä»£ç å®¡æŸ¥">
                    </div>
                    <div class="form-group">
                        <label>ç¤ºä¾‹æè¿°</label>
                        <textarea id="exampleDesc" placeholder="æè¿°è¿™ä¸ªç¤ºä¾‹çš„ä½¿ç”¨åœºæ™¯"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div id="preview" class="tab-content">
            <div class="editor">
                <div class="panel">
                    <h3>ğŸ“„ JSON é¢„è§ˆ</h3>
                    <pre id="jsonPreview" class="preview"></pre>
                    <button class="btn" onclick="downloadJSON()">ä¸‹è½½ JSON</button>
                    <button class="btn btn-secondary" onclick="copyJSON()">å¤åˆ¶ JSON</button>
                </div>
                <div class="panel">
                    <h3>ğŸ“ Markdown é¢„è§ˆ</h3>
                    <pre id="markdownPreview" class="preview"></pre>
                    <button class="btn" onclick="downloadMarkdown()">ä¸‹è½½ Markdown</button>
                    <button class="btn btn-secondary" onclick="copyMarkdown()">å¤åˆ¶ Markdown</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µ
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // å¦‚æœæ˜¯é¢„è§ˆé¡µï¼Œæ›´æ–°é¢„è§ˆå†…å®¹
            if (tabName === 'preview') {
                updatePreview();
            }
        }

        function updateParameters() {
            const content = document.getElementById('templateContent').value;
            const params = [...new Set((content.match(/\{(\w+)\}/g) || []).map(match => match.slice(1, -1)))];
            
            const container = document.getElementById('detectedParams');
            container.innerHTML = params.map(param => 
                `<span class="parameter-tag">{${param}}</span>`
            ).join('');
        }

        function updatePreview() {
            const data = collectFormData();
            
            // æ›´æ–°JSONé¢„è§ˆ
            document.getElementById('jsonPreview').textContent = JSON.stringify(data, null, 2);
            
            // æ›´æ–°Markdowné¢„è§ˆ
            const markdown = generateMarkdown(data);
            document.getElementById('markdownPreview').textContent = markdown;
        }

        function collectFormData() {
            const content = document.getElementById('templateContent').value;
            const params = [...new Set((content.match(/\{(\w+)\}/g) || []).map(match => match.slice(1, -1)))];
            
            const example = {
                name: document.getElementById('exampleName').value || "åŸºç¡€ç¤ºä¾‹",
                description: document.getElementById('exampleDesc').value || "æ¨¡æ¿ä½¿ç”¨ç¤ºä¾‹"
            };
            
            return {
                id: document.getElementById('templateId').value || 'new-template',
                type: 'prompt-template',
                name: document.getElementById('templateName').value || 'æ–°æ¨¡æ¿',
                description: document.getElementById('templateDesc').value || 'æ¨¡æ¿æè¿°',
                version: '1.0.0',
                author: 'mantras-team',
                tags: document.getElementById('templateTags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
                technique: document.getElementById('templateTechnique').value || 'new_technique',
                template: content,
                parameters: params,
                category: document.getElementById('templateCategory').value,
                examples: example.name ? [example] : [],
                metadata: {
                    created: new Date().toISOString().split('T')[0],
                    lastModified: new Date().toISOString().split('T')[0],
                    usageCount: 0,
                    rating: 0.0,
                    difficulty: document.getElementById('templateDifficulty').value
                }
            };
        }

        function generateMarkdown(data) {
            return `---
id: ${data.id}
type: ${data.type}
name: ${data.name}
description: ${data.description}
version: ${data.version}
author: ${data.author}
tags: [${data.tags.join(', ')}]
technique: ${data.technique}
category: ${data.category}
parameters: [${data.parameters.join(', ')}]
difficulty: ${data.metadata.difficulty}
rating: ${data.metadata.rating}
---

# ${data.name}

## ğŸ“ æ¨¡æ¿å†…å®¹

\`\`\`
${data.template}
\`\`\`

## ğŸ’¡ ä½¿ç”¨è¯´æ˜

${data.description}

## ğŸ¯ å‚æ•°è¯´æ˜

${data.parameters.map(param => `- **{${param}}**: è¯·æè¿°æ­¤å‚æ•°çš„ç”¨é€”`).join('\n')}

## ğŸ“Š å…ƒæ•°æ®

- **åˆ›å»ºæ—¶é—´**: ${data.metadata.created}
- **éš¾åº¦ç­‰çº§**: ${data.metadata.difficulty}
- **åˆ†ç±»**: ${data.category}`;
        }

        function downloadJSON() {
            const data = collectFormData();
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${data.id}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function downloadMarkdown() {
            const data = collectFormData();
            const markdown = generateMarkdown(data);
            const blob = new Blob([markdown], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${data.id}.md`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function copyJSON() {
            const data = collectFormData();
            navigator.clipboard.writeText(JSON.stringify(data, null, 2)).then(() => {
                showMessage('JSONå·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            });
        }

        function copyMarkdown() {
            const data = collectFormData();
            const markdown = generateMarkdown(data);
            navigator.clipboard.writeText(markdown).then(() => {
                showMessage('Markdownå·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            });
        }

        function showMessage(text, type) {
            const msg = document.createElement('div');
            msg.textContent = text;
            msg.className = type;
            msg.style.cssText = 'position:fixed;top:20px;right:20px;padding:10px 20px;border-radius:6px;background:white;box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:1000;';
            document.body.appendChild(msg);
            setTimeout(() => msg.remove(), 3000);
        }

        // äº‹ä»¶ç›‘å¬
        document.getElementById('templateContent').addEventListener('input', updateParameters);
        document.getElementById('templateId').addEventListener('input', () => {
            const id = document.getElementById('templateId').value;
            if (id && !document.getElementById('templateTechnique').value) {
                document.getElementById('templateTechnique').value = id.replace(/-/g, '_');
            }
        });
        
        // åˆå§‹åŒ–
        updateParameters();
    </script>
</body>
</html>