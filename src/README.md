# Mantras é¡¹ç›®æºç ç»“æ„

æœ¬æ–‡æ¡£æè¿°äº†é‡æ„åçš„ `src` ç›®å½•ç»“æ„ï¼Œæ—¨åœ¨æä¾›æ›´æ¸…æ™°ã€æ›´æœ‰ç»„ç»‡çš„ä»£ç æ¶æ„ã€‚

## ğŸ“ ç›®å½•ç»“æ„æ¦‚è§ˆ

```
src/
â”œâ”€â”€ core/                    # ğŸ¯ æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ infrastructure/          # ğŸ—ï¸ åŸºç¡€è®¾æ–½å±‚
â”œâ”€â”€ presentation/           # ğŸ¨ è¡¨ç¤ºå±‚
â”œâ”€â”€ shared/                 # ğŸ”— å…±äº«ç»„ä»¶
â”œâ”€â”€ tools/                  # ğŸ› ï¸ MCP å·¥å…·å®ç°
â””â”€â”€ types.ts               # ğŸ“ å…¨å±€ç±»å‹å®šä¹‰
```

## ğŸ¯ æ ¸å¿ƒæ¨¡å— (core/)

### ğŸ“¦ èµ„äº§ç®¡ç† (assets/)
è´Ÿè´£æ‰€æœ‰èµ„äº§çš„ç®¡ç†ã€åŠ è½½å’Œå¤„ç†ï¼š
- `asset-factory.ts` - èµ„äº§å·¥å‚
- `asset-loader.ts` - èµ„äº§åŠ è½½å™¨
- `asset-repository.ts` - èµ„äº§ä»“åº“
- `asset-sources.ts` - èµ„äº§æºé…ç½®
- `enhanced-asset-manager.ts` - å¢å¼ºèµ„äº§ç®¡ç†å™¨
- `unified-asset-manager.ts` - ç»Ÿä¸€èµ„äº§ç®¡ç†å™¨

### ğŸ§  å†…å­˜ç®¡ç† (memory/)
å¤„ç†ç³»ç»Ÿå†…å­˜å’ŒçŠ¶æ€ç®¡ç†ï¼š
- `memory.ts` - å†…å­˜ç®¡ç†æ ¸å¿ƒé€»è¾‘

### ğŸ­ äººæ ¼ç³»ç»Ÿ (personas/)
ç®¡ç† AI äººæ ¼çš„å¬å”¤å’Œç”Ÿå‘½å‘¨æœŸï¼š
- `persona-summoner.ts` - äººæ ¼å¬å”¤å™¨

### ğŸ“‹ æ¨¡æ¿ç³»ç»Ÿ (templates/)
æç¤ºå·¥ç¨‹æ¨¡æ¿å’Œæ¨¡æ¿ç®¡ç†ï¼š
- `prompt-templates.ts` - æç¤ºæ¨¡æ¿å®šä¹‰

## ğŸ—ï¸ åŸºç¡€è®¾æ–½å±‚ (infrastructure/)

### âš™ï¸ é…ç½®ç®¡ç† (config/)
ç³»ç»Ÿé…ç½®å’Œç¯å¢ƒå˜é‡ç®¡ç†ï¼š
- `environment.ts` - ç¯å¢ƒé…ç½®

### ğŸ“ æ—¥å¿—ç³»ç»Ÿ (logging/)
ç»Ÿä¸€çš„æ—¥å¿—è®°å½•å’Œç®¡ç†ï¼š
- `logger.ts` - æ—¥å¿—è®°å½•å™¨

### ğŸ–¥ï¸ æœåŠ¡å™¨ (server/)
MCP æœåŠ¡å™¨æ ¸å¿ƒå®ç°ï¼š
- `server.ts` - æœåŠ¡å™¨ä¸»é€»è¾‘

## ğŸ¨ è¡¨ç¤ºå±‚ (presentation/)

### ğŸ”Œ MCP æ¥å£ (mcp/)
Model Context Protocol ç›¸å…³çš„è¡¨ç¤ºå±‚é€»è¾‘ï¼š
- `tool-registry.ts` - å·¥å…·æ³¨å†Œè¡¨

## ğŸ”— å…±äº«ç»„ä»¶ (shared/)

### ğŸ“¦ ä¾èµ–æ³¨å…¥ (container/)
ä¾èµ–æ³¨å…¥å®¹å™¨å’ŒæœåŠ¡ç®¡ç†ï¼š
- `di-container.ts` - DI å®¹å™¨å®ç°

### âŒ é”™è¯¯å¤„ç† (errors/)
ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š
- `error-handler.ts` - é”™è¯¯å¤„ç†å™¨

### ğŸ› ï¸ å·¥å…·åŸºç¡€ (tools/)
MCP å·¥å…·çš„åŸºç¡€ç±»å’Œæ¥å£ï¼š
- `standard-mcp-tool.ts` - æ ‡å‡† MCP å·¥å…·åŸºç±»

## ğŸ› ï¸ å·¥å…·å®ç° (tools/)

å…·ä½“çš„ MCP å·¥å…·å®ç°ï¼š
- `agent-empowerment.tools.ts` - ä»£ç†å¢å¼ºå·¥å…·
- `enhanced-flexible-tools.ts` - å¢å¼ºçµæ´»å·¥å…·
- `flexible-mcp.tools.ts` - çµæ´» MCP å·¥å…·
- `improved-intent-analysis.ts` - æ”¹è¿›çš„æ„å›¾åˆ†æ
- `init.tool.ts` - åˆå§‹åŒ–å·¥å…·
- `memory.tool.ts` - å†…å­˜ç®¡ç†å·¥å…·
- `persona-discovery.tools.ts` - äººæ ¼å‘ç°å·¥å…·

## ğŸ“ å…¨å±€ç±»å‹ (types.ts)

å®šä¹‰æ•´ä¸ªé¡¹ç›®ä½¿ç”¨çš„é€šç”¨ç±»å‹å’Œæ¥å£ã€‚

## ğŸš€ ä½¿ç”¨æŒ‡å—

### å¯¼å…¥æ¨¡å—
æ¯ä¸ªä¸»è¦æ¨¡å—éƒ½æä¾›äº† `index.ts` æ–‡ä»¶ç”¨äºç»Ÿä¸€å¯¼å…¥ï¼š

```typescript
// å¯¼å…¥æ ¸å¿ƒèµ„äº§ç®¡ç†åŠŸèƒ½
import { AssetFactory, UnifiedAssetManager } from './core/assets';

// å¯¼å…¥åŸºç¡€è®¾æ–½ç»„ä»¶
import { logger } from './infrastructure/logging';
import { config } from './infrastructure/config';

// å¯¼å…¥å…±äº«å·¥å…·
import { DIContainer } from './shared/container';
```

### æ¨¡å—èŒè´£
- **core/**: åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¾èµ–å¤–éƒ¨åŸºç¡€è®¾æ–½
- **infrastructure/**: æä¾›æŠ€æœ¯åŸºç¡€è®¾æ–½ï¼Œå¯è¢«æ ¸å¿ƒæ¨¡å—ä½¿ç”¨
- **presentation/**: å¤„ç†å¤–éƒ¨æ¥å£å’Œåè®®é€‚é…
- **shared/**: æä¾›è·¨æ¨¡å—çš„é€šç”¨åŠŸèƒ½
- **tools/**: å®ç°å…·ä½“çš„ MCP å·¥å…·åŠŸèƒ½

## ğŸ”„ è¿ç§»è¯´æ˜

æ­¤é‡æ„ä¿æŒäº†æ‰€æœ‰ç°æœ‰åŠŸèƒ½çš„å®Œæ•´æ€§ï¼Œåªæ˜¯é‡æ–°ç»„ç»‡äº†æ–‡ä»¶ä½ç½®ã€‚å¦‚æœæ‚¨çš„ä»£ç ä¸­æœ‰å¯¼å…¥è·¯å¾„éœ€è¦æ›´æ–°ï¼Œè¯·å‚è€ƒæ–°çš„æ¨¡å—ç»“æ„è¿›è¡Œè°ƒæ•´ã€‚

## ğŸ“ˆ ä¼˜åŠ¿

1. **æ¸…æ™°çš„å…³æ³¨ç‚¹åˆ†ç¦»**: æ¯ä¸ªæ¨¡å—éƒ½æœ‰æ˜ç¡®çš„èŒè´£
2. **æ›´å¥½çš„å¯ç»´æŠ¤æ€§**: ç›¸å…³åŠŸèƒ½é›†ä¸­åœ¨ä¸€èµ·
3. **ä¾¿äºæ‰©å±•**: æ–°åŠŸèƒ½å¯ä»¥è½»æ¾æ·»åŠ åˆ°ç›¸åº”æ¨¡å—
4. **ç»Ÿä¸€çš„å¯¼å…¥æ–¹å¼**: é€šè¿‡ç´¢å¼•æ–‡ä»¶ç®€åŒ–å¯¼å…¥
5. **ç¬¦åˆæ¶æ„æœ€ä½³å®è·µ**: éµå¾ªåˆ†å±‚æ¶æ„åŸåˆ™